# 自定义插件

## 自定义插件是什么

正如名字所说, 自定义插件允许开发者开发自己的插件, 提供给别人使用, 同理也可以使用别的开发者分享的插件.

## 实现

从整个系统上来说, 我们的自定义插件系统分为两大部分:

* App 侧: 这里是真正的插件实现, 在自己的游戏应用中开发插件, 调用插件接口都是这一部分. 对外表现出来就是各种的插件.
* Installer 侧: 这里是辅助部分, 运行在 Mac/Windows 上, 主要作用就是下载, 更新插件, 并安装到应用工程中. 对外表现出来就是一个叫 `sbc` 的命令行工具.

### App 侧实现

自定义插件的层级结构图应该是这样.

<img :src="$withBase('/assets/img/CustomPluginStruct.svg')" alt="CustomPluginStruct">

上图中, 除了 Game 部分, 其它均属于自定义插件部分.
我们又把自定义插件部分分成了两个插件, 其中一个是红色背景的基础插件 `Bridge` . 另一个是橙色背景实现具体功能插件 `Plugin`.

开发者在 Game 中调用 `Plugin` 插件的 Cpp/Lua/JS 接口, 再通过 `Bridge` 插件 调用到 `Plugin` 的对应平台实现.

关于图中的 `Plugin` 插件, 由图可知, 是由三个大部分组成的:

* Cpp/Lua/JS 部分: 这里是直接面向开发者, 开发者基本也是通过这里接口调用到插件的功能. (从图中可知, 也可以不提供这一部分, 而让开发者直接通过 Bridge 去调用插件功能, 但是我们不推荐这样做)
* Android 部分: 插件在 Android 平台的实现, 如果是 SDK 的封装, 那么这里应该也包括对应 SDK
* iOS 部分: 插件在 iOS 平台的实现, 如果是 SDK 的封装, 那么这里应该也包括对应 SDK

关于图中的 `Bridge` 插件:

这个插件就是启到一个联接的作用, 联接了 `Plugin` 插件中的 Cpp/Lua/JS 与 Android/iOS.
让 `Plugin` 中的平台实现部分可以只关心功能实现.

### Installer 侧实现

自定义插件的 Installer , 我们命名为 `sbc` . 使用这个命令行来安装更新插件.
